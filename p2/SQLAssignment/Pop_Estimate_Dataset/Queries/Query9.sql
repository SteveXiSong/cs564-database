SELECT 
	H_OUT.STNAME, CAST(SUMP AS REAL) / CAST(SUMP2 AS REAL)*100
FROM 
	(
		SELECT 
			H2.STNAME, SUM(P2.POPESTIMATE2011) AS SUMP2 
		FROM
			HOUSING_UNITS_STATE_LEVEL AS H2
			NATURAL JOIN
			POP_ESTIMATE_STATE_AGE_SEX_RACE_ORIGIN AS P2
		WHERE
			ORIGIN = 0
			AND
			SEX = 0
		GROUP BY 
			P2.STATE
	) AS H_OUT 
	--select all ages, which counted the total sex and total origin
	NATURAL JOIN
	(
		SELECT 
			H.STNAME, SUM(P.POPESTIMATE2011) AS SUMP 
		FROM
			HOUSING_UNITS_STATE_LEVEL AS H 
			NATURAL JOIN
			POP_ESTIMATE_STATE_AGE_SEX_RACE_ORIGIN AS P 
		WHERE
			ORIGIN = 0
			AND
			SEX = 0
			AND
			P.AGE >= 21	
		GROUP BY 
			P.STATE
	) AS H_IN
	--select ages greater than 21
;

/*
UNION

SELECT 
	H2.STNAME, SUM(P2.POPESTIMATE2011)
FROM 
	POP_ESTIMATE_STATE_AGE_SEX_RACE_ORIGIN AS P2
	NATURAL JOIN
	HOUSING_UNITS_STATE_LEVEL AS H2
WHERE 
	H2.STATE = P2.STATE
GROUP BY
	P2.STATE
;*/
